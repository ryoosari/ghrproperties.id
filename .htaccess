# Enable rewrite engine
RewriteEngine On

# Set the base
RewriteBase /

# Rules to properly serve images, scripts, CSS, and other static assets
RewriteCond %{REQUEST_URI} !\.(html|js|css|png|jpg|jpeg|gif|svg|ico|webp|avif|json)$
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^properties(/.*)?$ properties$1.html [L]

# Handling 404 errors
ErrorDocument 404 /404.html

# Handle direct access to HTML files
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /([^\ ]+)\.html
RewriteRule ^(.*)\.html$ /$1 [R=301,L]

# Default rule - direct all non-file/directory requests to index.html
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.html [L]

# Set security headers
<IfModule mod_headers.c>
  Header set X-Content-Type-Options "nosniff"
  Header set X-XSS-Protection "1; mode=block"
  Header set X-Frame-Options "SAMEORIGIN"
  Header set Referrer-Policy "strict-origin-when-cross-origin"
  Header set Permissions-Policy "geolocation=(), microphone=(), camera=()"
</IfModule>

# Enable CORS
<IfModule mod_headers.c>
  Header set Access-Control-Allow-Origin "*"
</IfModule>
